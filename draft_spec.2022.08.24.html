<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Document Picture-in-Picture Specification</title>
  <meta content="w3c/UD" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-UD" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <meta content="Bikeshed version e8a706a4b, updated Fri Jul 15 11:08:03 2022 -0700" name="generator">
  <link href="http://example.com/url-this-spec-will-live-at" rel="canonical">
  <meta content="6c109faea58c9996b51729575e4792054587c95c" name="document-revision">
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */

a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Document Picture-in-Picture Specification</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#UD">Unofficial Proposal Draft</a>, <time class="dt-updated" datetime="2022-08-24">24 August 2022</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="http://example.com/url-this-spec-will-live-at">http://example.com/url-this-spec-will-live-at</a>
      <dt>Issue Tracking:
      <dd><a href="https://github.com/w3c/document-pip/issues/">GitHub</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:steimel@google.com">Tommy Steimel</a> (<span class="p-org org">Google Inc.</span>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2022 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification enables web developers to populate an HTMLDocument

in an always-on-top window.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at https://www.w3.org/TR/.</em> </p>
   <p> Feedback and comments on this specification are welcome. <a href="https://github.com/w3c/document-pip/issues">GitHub Issues</a> are preferred for discussion on this specification. Alternatively, you can send comments to the Media Working Group’s mailing-list, <a href="mailto:public-media-wg@w3.org">public-media-wg@w3.org</a> (<a href="https://lists.w3.org/Archives/Public/public-media-wg/">archives</a>).
  This draft highlights some of the pending issues that are still to be discussed in the working group.
  No decision has been taken on the outcome of these issues including whether they are valid. </p>
   <p> This document was produced by a group operating under the <a class="css" data-link-type="property" href="https://www.w3.org/Consortium/Patent-Policy/" id="sotd_patent">W3C Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/groups/wg/media/ipr" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2021/Process-20211102/" id="w3c_process_revision">2 November 2021 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#dependencies"><span class="secno">2</span> <span class="content">Dependencies</span></a>
    <li>
     <a href="#security-privacy-considerations"><span class="secno">3</span> <span class="content">Security and Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#secure-context"><span class="secno">3.1</span> <span class="content">Secure Context</span></a>
      <li><a href="#spoofing"><span class="secno">3.2</span> <span class="content">Spoofing</span></a>
      <li><a href="#fingerprinting"><span class="secno">3.3</span> <span class="content">Fingerprinting</span></a>
     </ol>
    <li><a href="#api"><span class="secno">4</span> <span class="content">API</span></a>
    <li>
     <a href="#concepts"><span class="secno">5</span> <span class="content">Concepts</span></a>
     <ol class="toc">
      <li><a href="#open-pip"><span class="secno">5.1</span> <span class="content">Open DocumentPictureInPictureSession</span></a>
      <li><a href="#concept-set-aspect-ratio"><span class="secno">5.2</span> <span class="content">Set Aspect Ratio</span></a>
      <li><a href="#concept-lock-aspect-ratio"><span class="secno">5.3</span> <span class="content">Lock Aspect Ratio</span></a>
      <li><a href="#pip-support"><span class="secno">5.4</span> <span class="content">Document Picture-in-Picture Support</span></a>
      <li><a href="#one-pip-window"><span class="secno">5.5</span> <span class="content">One PiP Window</span></a>
      <li><a href="#relative-urls"><span class="secno">5.6</span> <span class="content">Relative URLs</span></a>
     </ol>
    <li>
     <a href="#examples"><span class="secno">6</span> <span class="content">Examples</span></a>
     <ol class="toc">
      <li>
       <a href="#example-video-player"><span class="secno">6.1</span> <span class="content">Extracting a video player into PiP</span></a>
       <ol class="toc">
        <li><a href="#example-video-player-html"><span class="secno">6.1.1</span> <span class="content">HTML</span></a>
        <li><a href="#example-video-player-js"><span class="secno">6.1.2</span> <span class="content">JavaScript</span></a>
       </ol>
      <li><a href="#example-access-elements"><span class="secno">6.2</span> <span class="content">Accessing elements on the PiP Window</span></a>
      <li><a href="#example-listen-events"><span class="secno">6.3</span> <span class="content">Listening to events on the PiP Window</span></a>
      <li><a href="#example-exiting-pip"><span class="secno">6.4</span> <span class="content">Exiting PiP</span></a>
      <li><a href="#example-aspect-ratio"><span class="secno">6.5</span> <span class="content">Changing aspect ratio</span></a>
      <li><a href="#example-elements-out-on-close"><span class="secno">6.6</span> <span class="content">Getting elements out of the PiP window when it closes</span></a>
     </ol>
    <li><a href="#acknowledgments"><span class="secno">7</span> <span class="content">Acknowledgments</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is non-normative.</em></p>
   <p>There currently exists a Web API for putting an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#htmlvideoelement" id="ref-for-htmlvideoelement">HTMLVideoElement</a></code> into a
Picture-in-Picture window (<code>requestPictureInPicture()</code>). This limits
a website’s ability to provide a custom picture-in-picture experience (PiP). We
want to expand upon that functionality by providing the website with a full <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> on an always-on-top window.</p>
   <p>This new window will be much like a blank same-origin window opened via the
existing <a class="idl-code" data-link-type="method" href="https://html.spec.whatwg.org/multipage/window-object.html#dom-open" id="ref-for-dom-open">open()</a> method on <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window">Window</a></code>, with some minor
differences:</p>
   <ul>
    <li data-md>
     <p>The PiP window will float on top of other windows.</p>
    <li data-md>
     <p>The PiP window will never outlive the opening window.</p>
    <li data-md>
     <p>The website cannot set the position of the PiP window.</p>
    <li data-md>
     <p>The PiP window cannot be navigated (any `window.history` or `window.location`
calls that change to a new document will close the PiP window).</p>
    <li data-md>
     <p>The PiP window cannot open more windows.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="dependencies"><span class="secno">2. </span><span class="content">Dependencies</span><a class="self-link" href="#dependencies"></a></h2>
   <p>The IDL fragments in this specification must be interpreted as required for
conforming IDL fragments, as described in the Web IDL specification. <a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a></p>
   <h2 class="heading settled" data-level="3" id="security-privacy-considerations"><span class="secno">3. </span><span class="content">Security and Privacy Considerations</span><a class="self-link" href="#security-privacy-considerations"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="secure-context"><span class="secno">3.1. </span><span class="content">Secure Context</span><a class="self-link" href="#secure-context"></a></h3>
   <p>The API is limited to <a data-link-type="biblio" href="#biblio-secure-contexts">[SECURE-CONTEXTS]</a>.</p>
   <p>TODO: Why? Especially given that both the original PiP API and the window.open()
API are allowed on non-secure contexts.</p>
   <h3 class="heading settled" data-level="3.2" id="spoofing"><span class="secno">3.2. </span><span class="content">Spoofing</span><a class="self-link" href="#spoofing"></a></h3>
   <p>It is RECOMMENDED that the user agent provides enough UI on the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession">DocumentPictureInPictureSession</a></code> to prevent malicious websites from abusing
the ability to float on top of other windows to spoof other websites or system
UI. The website’s inability to directly set the location or size of the PiP
window helps alleviate some avenues of abuse.</p>
   <p>It is RECOMMENDED that the user agent makes it clear to the user which origin is
controlling the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①">DocumentPictureInPictureSession</a></code> at all times.</p>
   <h3 class="heading settled" data-level="3.3" id="fingerprinting"><span class="secno">3.3. </span><span class="content">Fingerprinting</span><a class="self-link" href="#fingerprinting"></a></h3>
   <p>When a PiP window is closed and then later re-opened, it can be useful for the
user agent to re-use size and location of the previous PiP window (modulo
aspect-ratio constraints) to provide a smoother user experience. However, it is
RECOMMENDED that the user agent does not re-use size/location across different
origins as this may provide malicious websites an avenue for fingerprinting
a user.</p>
   <h2 class="heading settled" data-level="4" id="api"><span class="secno">4. </span><span class="content">API</span><a class="self-link" href="#api"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator" id="ref-for-navigator"><c- g>Navigator</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject"><c- g>SameObject</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#pictureinpicture" id="ref-for-pictureinpicture"><c- n>PictureInPicture</c-></a>
    <dfn class="idl-code" data-dfn-for="Navigator" data-dfn-type="attribute" data-export data-readonly data-type="PictureInPicture" id="dom-navigator-pictureinpicture"><code><c- g>pictureInPicture</c-></code><a class="self-link" href="#dom-navigator-pictureinpicture"></a></dfn>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="pictureinpicture"><code><c- g>PictureInPicture</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession②"><c- n>DocumentPictureInPictureSession</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="PictureInPicture" data-dfn-type="method" data-export data-lt="requestWindow(options)|requestWindow()" id="dom-pictureinpicture-requestwindow"><code><c- g>requestWindow</c-></code></dfn>(
    <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-documentpictureinpictureoptions" id="ref-for-dictdef-documentpictureinpictureoptions"><c- n>DocumentPictureInPictureOptions</c-></a> <dfn class="idl-code" data-dfn-for="PictureInPicture/requestWindow(options), PictureInPicture/requestWindow()" data-dfn-type="argument" data-export id="dom-pictureinpicture-requestwindow-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-pictureinpicture-requestwindow-options-options"></a></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession③"><c- n>DocumentPictureInPictureSession</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="PictureInPicture" data-dfn-type="attribute" data-export data-readonly data-type="DocumentPictureInPictureSession" id="dom-pictureinpicture-session"><code><c- g>session</c-></code></dfn>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <dfn class="idl-code" data-dfn-for="PictureInPicture" data-dfn-type="attribute" data-export data-type="EventHandler" id="dom-pictureinpicture-onenterpictureinpicture"><code><c- g>onenterpictureinpicture</c-></code><a class="self-link" href="#dom-pictureinpicture-onenterpictureinpicture"></a></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-documentpictureinpictureoptions"><code><c- g>DocumentPictureInPictureOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-float" id="ref-for-idl-float"><c- b>float</c-></a> <dfn class="dfn-paneled idl-code" data-default="0.0" data-dfn-for="DocumentPictureInPictureOptions" data-dfn-type="dict-member" data-export data-type="float " id="dom-documentpictureinpictureoptions-initialaspectratio"><code><c- g>initialAspectRatio</c-></code></dfn> = 0.0;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="DocumentPictureInPictureOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-documentpictureinpictureoptions-lockaspectratio"><code><c- g>lockAspectRatio</c-></code></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="DocumentPictureInPictureOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-documentpictureinpictureoptions-copystylesheets"><code><c- g>copyStyleSheets</c-></code></dfn> = <c- b>false</c->;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="documentpictureinpicturesession"><code><c- g>DocumentPictureInPictureSession</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject①"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①"><c- n>Document</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="DocumentPictureInPictureSession" data-dfn-type="attribute" data-export data-readonly data-type="Document?" id="dom-documentpictureinpicturesession-document"><code><c- g>document</c-></code></dfn>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject②"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①"><c- n>Window</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="DocumentPictureInPictureSession" data-dfn-type="attribute" data-export data-readonly data-type="Window?" id="dom-documentpictureinpicturesession-window"><code><c- g>window</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="DocumentPictureInPictureSession" data-dfn-type="method" data-export data-lt="setAspectRatio(aspectRatio)" id="dom-documentpictureinpicturesession-setaspectratio"><code><c- g>setAspectRatio</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-float" id="ref-for-idl-float①"><c- b>float</c-></a> <dfn class="idl-code" data-dfn-for="DocumentPictureInPictureSession/setAspectRatio(aspectRatio)" data-dfn-type="argument" data-export id="dom-documentpictureinpicturesession-setaspectratio-aspectratio-aspectratio"><code><c- g>aspectRatio</c-></code><a class="self-link" href="#dom-documentpictureinpicturesession-setaspectratio-aspectratio-aspectratio"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①"><c- b>undefined</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="DocumentPictureInPictureSession" data-dfn-type="method" data-export data-lt="setLockAspectRatio(lockAspectRatio)" id="dom-documentpictureinpicturesession-setlockaspectratio"><code><c- g>setLockAspectRatio</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <dfn class="idl-code" data-dfn-for="DocumentPictureInPictureSession/setLockAspectRatio(lockAspectRatio)" data-dfn-type="argument" data-export id="dom-documentpictureinpicturesession-setlockaspectratio-lockaspectratio-lockaspectratio"><code><c- g>lockAspectRatio</c-></code><a class="self-link" href="#dom-documentpictureinpicturesession-setlockaspectratio-lockaspectratio-lockaspectratio"></a></dfn>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="documentpictureinpictureevent"><code><c- g>DocumentPictureInPictureEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event"><c- n>Event</c-></a> {
  <dfn class="idl-code" data-dfn-for="DocumentPictureInPictureEvent" data-dfn-type="constructor" data-export data-lt="DocumentPictureInPictureEvent(type, eventInitDict)|constructor(type, eventInitDict)" id="dom-documentpictureinpictureevent-documentpictureinpictureevent"><code><c- g>constructor</c-></code><a class="self-link" href="#dom-documentpictureinpictureevent-documentpictureinpictureevent"></a></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="DocumentPictureInPictureEvent/DocumentPictureInPictureEvent(type, eventInitDict), DocumentPictureInPictureEvent/constructor(type, eventInitDict)" data-dfn-type="argument" data-export id="dom-documentpictureinpictureevent-documentpictureinpictureevent-type-eventinitdict-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-documentpictureinpictureevent-documentpictureinpictureevent-type-eventinitdict-type"></a></dfn>, <a data-link-type="idl-name" href="#dictdef-documentpictureinpictureeventinit" id="ref-for-dictdef-documentpictureinpictureeventinit"><c- n>DocumentPictureInPictureEventInit</c-></a> <dfn class="idl-code" data-dfn-for="DocumentPictureInPictureEvent/DocumentPictureInPictureEvent(type, eventInitDict), DocumentPictureInPictureEvent/constructor(type, eventInitDict)" data-dfn-type="argument" data-export id="dom-documentpictureinpictureevent-documentpictureinpictureevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code><a class="self-link" href="#dom-documentpictureinpictureevent-documentpictureinpictureevent-type-eventinitdict-eventinitdict"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject③"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession④"><c- n>DocumentPictureInPictureSession</c-></a>
    <dfn class="dfn-paneled idl-code" data-dfn-for="DocumentPictureInPictureEvent" data-dfn-type="attribute" data-export data-readonly data-type="DocumentPictureInPictureSession" id="dom-documentpictureinpictureevent-pictureinpicturesession"><code><c- g>pictureInPictureSession</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-documentpictureinpictureeventinit"><code><c- g>DocumentPictureInPictureEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit" id="ref-for-dictdef-eventinit"><c- n>EventInit</c-></a> {
  <c- b>required</c-> <a data-link-type="idl-name" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession⑤"><c- n>DocumentPictureInPictureSession</c-></a> <dfn class="idl-code" data-dfn-for="DocumentPictureInPictureEventInit" data-dfn-type="dict-member" data-export data-type="DocumentPictureInPictureSession " id="dom-documentpictureinpictureeventinit-pictureinpicturesession"><code><c- g>pictureInPictureSession</c-></code><a class="self-link" href="#dom-documentpictureinpictureeventinit-pictureinpicturesession"></a></dfn>;
};
</pre>
   <p> A <code class="idl"><a data-link-type="idl" href="#pictureinpicture" id="ref-for-pictureinpicture①">PictureInPicture</a></code> object allows websites to create and open a new <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession⑥">DocumentPictureInPictureSession</a></code> as well as listen for events related to
opening and closing a <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession⑦">DocumentPictureInPictureSession</a></code>. </p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-pictureinpicture-session" id="ref-for-dom-pictureinpicture-session">session</a></code> attribute’s getter MUST return the currently
open <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession⑧">DocumentPictureInPictureSession</a></code> for the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context">browsing context</a> if there is one. Otherwise, it MUST return <code>null</code>.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-pictureinpicture-requestwindow" id="ref-for-dom-pictureinpicture-requestwindow">requestWindow(options)</a></code> method, when invoked, MUST return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>:</p>
   <ol>
    <li data-md>
     <p>Run the <a data-link-type="dfn" href="#open-documentpictureinpicturesession" id="ref-for-open-documentpictureinpicturesession">open DocumentPictureInPictureSession</a> algorithm with <var>options</var>.</p>
    <li data-md>
     <p>If the previous step threw an exception, reject <var>promise</var> with that exception
and abort these steps.</p>
    <li data-md>
     <p>Return <var>promise</var> with the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession⑨">DocumentPictureInPictureSession</a></code> from step 1.</p>
   </ol>
   <p></p>
   <p> A <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①⓪">DocumentPictureInPictureSession</a></code> object represents an always-on-top PiP
window opened by <code class="idl"><a data-link-type="idl" href="#dom-pictureinpicture-requestwindow" id="ref-for-dom-pictureinpicture-requestwindow①">requestWindow()</a></code>. It gives the website a handle into the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> contained in the window. </p>
   <p> The <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-setaspectratio" id="ref-for-dom-documentpictureinpicturesession-setaspectratio">setAspectRatio(aspectRatio)</a></code> method, when invoked, MUST return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise①">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①">in parallel</a>: </p>
   <ol>
    <li data-md>
     <p>Run the <a data-link-type="dfn" href="#set-aspect-ratio" id="ref-for-set-aspect-ratio">set aspect ratio</a> algorithm with <var>aspectRatio</var>.</p>
    <li data-md>
     <p>If the previous step threw an exception, reject <var>promise</var> with that exception
and abort these steps.</p>
    <li data-md>
     <p>Resolve and return <var>promise</var>.</p>
   </ol>
   <p></p>
   <p> The <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-setlockaspectratio" id="ref-for-dom-documentpictureinpicturesession-setlockaspectratio">setLockAspectRatio(lockAspectRatio)</a></code> method, when invoked, MUST return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise②">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel②">in parallel</a>: </p>
   <ol>
    <li data-md>
     <p>Run the <a data-link-type="dfn" href="#set-lock-aspect-ratio" id="ref-for-set-lock-aspect-ratio">set lock aspect ratio</a> algorithm with <var>lockAspectRatio</var>.</p>
    <li data-md>
     <p>If the previous step threw an exception, reject <var>promise</var> with that exception
and abort these steps.</p>
    <li data-md>
     <p>Resolve and return <var>promise</var>.</p>
   </ol>
   <p></p>
   <dl>
    <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="PictureInPicture" data-dfn-type="event" data-export id="eventdef-pictureinpicture-enterpictureinpicture"><code>enterpictureinpicture</code></dfn>
    <dd data-md>
     <p>Fired on <code class="idl"><a data-link-type="idl" href="#pictureinpicture" id="ref-for-pictureinpicture②">PictureInPicture</a></code> when a PiP window is opened.</p>
   </dl>
   <h2 class="heading settled" data-level="5" id="concepts"><span class="secno">5. </span><span class="content">Concepts</span><a class="self-link" href="#concepts"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="open-pip"><span class="secno">5.1. </span><span class="content">Open DocumentPictureInPictureSession</span><a class="self-link" href="#open-pip"></a></h3>
   <p>When the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="open-documentpictureinpicturesession">open DocumentPictureInPictureSession</dfn> algorithm is invoked
with <var>options</var> on <var>pictureInPicture</var> of type <code class="idl"><a data-link-type="idl" href="#pictureinpicture" id="ref-for-pictureinpicture③">PictureInPicture</a></code>, the user
agent MUST run the following steps:</p>
   <ol>
    <li data-md>
     <p>If <a data-link-type="dfn" href="#document-picture-in-picture-support" id="ref-for-document-picture-in-picture-support">Document Picture-in-Picture support</a> is <code>false</code>, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#notsupportederror" id="ref-for-notsupportederror">NotSupportedError</a></code> and abort these steps.</p>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> of <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a> does not have <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation" id="ref-for-transient-activation">transient activation</a>, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#notallowederror" id="ref-for-notallowederror">NotAllowedError</a></code> and abort these
steps.</p>
    <li data-md>
     <p>The user agent MAY choose to close any existing <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①①">DocumentPictureInPictureSession</a></code>s or <a data-link-type="idl" href="https://w3c.github.io/picture-in-picture/#pictureinpicturewindow">PictureInPictureWindow</a>s.</p>
    <li data-md>
     <p>Let <var>target browsing context</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context" id="ref-for-browsing-context①">browsing context</a> navigated to
the <code>about:blank</code> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL</a>.</p>
    <li data-md>
     <p>If <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpictureoptions-initialaspectratio" id="ref-for-dom-documentpictureinpictureoptions-initialaspectratio">initialAspectRatio</a></code> exists
and is greater than zero:</p>
     <ol>
      <li data-md>
       <p>OPTIONALLY, clamp or ignore <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpictureoptions-initialaspectratio" id="ref-for-dom-documentpictureinpictureoptions-initialaspectratio①">initialAspectRatio</a></code> if it is too large
or too small in order to fit a user-friendly window size.</p>
      <li data-md>
       <p>Set the window size for the <var>target browsing context</var> to a <var>width</var> and <var>height</var> such that <var>width</var> divided by <var>height</var> is approximately <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpictureoptions-initialaspectratio" id="ref-for-dom-documentpictureinpictureoptions-initialaspectratio②">initialAspectRatio</a></code>.</p>
      <li data-md>
       <p>If <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpictureoptions-lockaspectratio" id="ref-for-dom-documentpictureinpictureoptions-lockaspectratio">lockAspectRatio</a></code> exists
and is <code>true</code>, then the window should be configured such that
when a user resizes it, the aspect ratio of the window should remain
constant.</p>
     </ol>
    <li data-md>
     <p>Configure the window containing <var>target browsing context</var> to float on top of
other windows.</p>
    <li data-md>
     <p>If <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpictureoptions-copystylesheets" id="ref-for-dom-documentpictureinpictureoptions-copystylesheets">copyStyleSheets</a></code> exists and
is <code>true</code>, then the <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-style-sheet" id="ref-for-css-style-sheet">CSS style sheet</a>s applied the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window" id="ref-for-concept-document-window">associated Document</a> should be copied and applied to the <var>target browsing context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window" id="ref-for-concept-document-window①">associated Document</a>. This is a one-time
copy, and any further changes to the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window" id="ref-for-concept-document-window②">associated Document</a>’s <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-style-sheet" id="ref-for-css-style-sheet①">CSS style sheet</a>s will not be copied.</p>
    <li data-md>
     <p>Let <var>pipSession</var> be a <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①②">DocumentPictureInPictureSession</a></code> object with the <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-document" id="ref-for-dom-documentpictureinpicturesession-document">document</a></code> attribute set to <var>target
browsing context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window" id="ref-for-concept-document-window③">associated Document</a> and the <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-window" id="ref-for-dom-documentpictureinpicturesession-window">window</a></code> attribute set to <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-document" id="ref-for-dom-documentpictureinpicturesession-document①">document</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#dom-document-defaultview" id="ref-for-dom-document-defaultview">defaultView</a></code>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire">fire an event</a> named <code class="idl"><a data-link-type="idl" href="#eventdef-pictureinpicture-enterpictureinpicture" id="ref-for-eventdef-pictureinpicture-enterpictureinpicture">enterpictureinpicture</a></code> using <code class="idl"><a data-link-type="idl" href="#documentpictureinpictureevent" id="ref-for-documentpictureinpictureevent">DocumentPictureInPictureEvent</a></code> on <var>pictureInPicture</var> with its <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-bubbles" id="ref-for-dom-event-bubbles">bubbles</a></code> attribute initialized to <code>true</code> and its <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpictureevent-pictureinpicturesession" id="ref-for-dom-documentpictureinpictureevent-pictureinpicturesession">pictureInPictureSession</a></code> attribute
initialized to <var>pipSession</var>.</p>
    <li data-md>
     <p>Return <var>pipSession</var>.</p>
   </ol>
   <p class="note" role="note"> While the aspect ratio of the window can be configured by the website, the
initial size and position is left to the discretion of the user agent. </p>
   <h3 class="heading settled" data-level="5.2" id="concept-set-aspect-ratio"><span class="secno">5.2. </span><span class="content">Set Aspect Ratio</span><a class="self-link" href="#concept-set-aspect-ratio"></a></h3>
   <p>When the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-aspect-ratio">set aspect ratio</dfn> algorithm is invoked with <var>aspectRatio</var> on <var>pipSession</var> of type <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①③">DocumentPictureInPictureSession</a></code>, the user agent MUST run
the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>aspectRatio</var> &lt;= 0, throw a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror">RangeError</a></code> and abort these steps.</p>
    <li data-md>
     <p>If <var>pipSession</var> has already closed, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror">InvalidStateError</a></code> and abort
these steps.</p>
    <li data-md>
     <p>OPTIONALLY, clamp or ignore <var>aspectRatio</var> if it is too large or too small in
order to fit a user-friendly window size.</p>
    <li data-md>
     <p>Resize the window represented by <var>pipSession</var> to a <var>width</var> and <var>height</var> such
that <var>width</var> divided by <var>height</var> is approximately <var>aspectRatio</var> or the
alternative value determined in step 3.</p>
   </ol>
   <p class="note" role="note"> It is RECOMMENDED that when resizing to the new aspect ratio the user agent
attempt to keep the total area and position of the window as consistent to the
original total area and position as possible. </p>
   <h3 class="heading settled" data-level="5.3" id="concept-lock-aspect-ratio"><span class="secno">5.3. </span><span class="content">Lock Aspect Ratio</span><a class="self-link" href="#concept-lock-aspect-ratio"></a></h3>
   <p>When the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-lock-aspect-ratio">set lock aspect ratio</dfn> algorithm is invoked with <var>lockAspectRatio</var> on <var>pipSession</var> of type <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①④">DocumentPictureInPictureSession</a></code>, the
user agent MUST run the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>pipSession</var> has already closed, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror①">InvalidStateError</a></code> and abort
these steps.</p>
    <li data-md>
     <p>If <var>lockAspectRatio</var> is <code>true</code>, then the window represented by <var>pipSession</var> should be configured such that when a user resizes it, the
aspect ratio of the window should remain constant.</p>
    <li data-md>
     <p>If <var>lockAspectRatio</var> is <code>false</code>, the the window represented by <var>pipSession</var> should no longer be configured to keep the aspect ratio
constant.</p>
   </ol>
   <h3 class="heading settled" data-level="5.4" id="pip-support"><span class="secno">5.4. </span><span class="content">Document Picture-in-Picture Support</span><a class="self-link" href="#pip-support"></a></h3>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="document-picture-in-picture-support">Document Picture-in-Picture Support</dfn> is <code>false</code> if there’s
a user preference that disables it or a platform limitation. It is <code>true</code> otherwise.</p>
   <h3 class="heading settled" data-level="5.5" id="one-pip-window"><span class="secno">5.5. </span><span class="content">One PiP Window</span><a class="self-link" href="#one-pip-window"></a></h3>
   <p>Whether only one window is allowed in Picture-in-Picture mode is left to the
implementation and the platform. As such, what happens when there is a
Picture-in-Picture request while a <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①⑤">DocumentPictureInPictureSession</a></code> or <a data-link-type="idl" href="https://w3c.github.io/picture-in-picture/#pictureinpicturewindow">PictureInPictureWindow</a> is already open will be left as an implementation detail: the current window
could be closed, the Picture-in-Picture request could be rejected, or multiple
Picture-in-Picture windows could be created. Regardless, the user agent MUST
fire the appropriate events in order to notify the websites of the
Picture-in-Picture status changes.</p>
   <h3 class="heading settled" data-level="5.6" id="relative-urls"><span class="secno">5.6. </span><span class="content">Relative URLs</span><a class="self-link" href="#relative-urls"></a></h3>
   <p>A primary use case of <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①⑥">DocumentPictureInPictureSession</a></code> is to put existing
elements (e.g. an <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#htmlvideoelement" id="ref-for-htmlvideoelement①">HTMLVideoElement</a></code>) into an always-on-top window so the user
can continue to see them while multitasking. However, sometimes these elements
have attributes that use a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#relative-url-string" id="ref-for-relative-url-string">relative-URL string</a> (e.g. <a class="idl-code" data-link-type="attribute" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-src" id="ref-for-dom-media-src">src</a>). Since the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code> in a <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①⑦">DocumentPictureInPictureSession</a></code> is always navigated to the <code>about:blank</code> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a>, these <a data-link-type="dfn" href="https://url.spec.whatwg.org/#relative-url-string" id="ref-for-relative-url-string①">relative-URL string</a>s would
break. To prevent this, the user agent MUST parse <a data-link-type="dfn" href="https://url.spec.whatwg.org/#relative-url-string" id="ref-for-relative-url-string②">relative-URL string</a>s as
if they were being parsed on the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code> that opened the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①⑧">DocumentPictureInPictureSession</a></code>.</p>
   <h2 class="heading settled" data-level="6" id="examples"><span class="secno">6. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h2>
   <p><em>This section is non-normative</em></p>
   <h3 class="heading settled" data-level="6.1" id="example-video-player"><span class="secno">6.1. </span><span class="content">Extracting a video player into PiP</span><a class="self-link" href="#example-video-player"></a></h3>
   <h4 class="heading settled" data-level="6.1.1" id="example-video-player-html"><span class="secno">6.1.1. </span><span class="content">HTML</span><a class="self-link" href="#example-video-player-html"></a></h4>
<pre class="lang-html highlight"><c- p>&lt;</c-><c- f>body</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>div</c-> <c- e>id</c-><c- o>=</c-><c- s>"player-container"</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>div</c-> <c- e>id</c-><c- o>=</c-><c- s>"player"</c-><c- p>></c->
      <c- p>&lt;</c-><c- f>video</c-> <c- e>id</c-><c- o>=</c-><c- s>"video"</c-> <c- e>src</c-><c- o>=</c-><c- s>"foo.webm"</c-><c- p>>&lt;/</c-><c- f>video</c-><c- p>></c->
      <c- d>&lt;!-- More player elements here. --></c->
    <c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>div</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>input</c-> <c- e>type</c-><c- o>=</c-><c- s>"button"</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"enterPiP();"</c-> <c- e>value</c-><c- o>=</c-><c- s>"Enter PiP"</c-> <c- p>/></c->
<c- p>&lt;/</c-><c- f>body</c-><c- p>></c->
</pre>
   <h4 class="heading settled" data-level="6.1.2" id="example-video-player-js"><span class="secno">6.1.2. </span><span class="content">JavaScript</span><a class="self-link" href="#example-video-player-js"></a></h4>
<pre class="lang-javascript highlight"><c- c1>// Handle to the picture-in-picture window.</c->
<c- a>let</c-> pipSession <c- o>=</c-> <c- kc>null</c-><c- p>;</c->

<c- a>function</c-> enterPiP<c- p>()</c-> <c- p>{</c->
  <c- a>const</c-> player <c- o>=</c-> document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#player'</c-><c- p>);</c->

  <c- c1>// Lock the aspect ratio so the window is always properly sized to the video.</c->
  <c- a>const</c-> pipOptions <c- o>=</c-> <c- p>{</c->
    initialAspectRatio<c- o>:</c-> player<c- p>.</c->clientWidth <c- o>/</c-> player<c- p>.</c->clientHeight<c- p>,</c->
    lockAspectRatio<c- o>:</c-> <c- kc>true</c-><c- p>,</c->
    copyStyleSheets<c- o>:</c-> <c- kc>true</c->
  <c- p>};</c->

  navigator<c- p>.</c->pictureInPicture<c- p>.</c->requestWindow<c- p>(</c->pipOptions<c- p>).</c->then<c- p>((</c->_pipSession<c- p>)</c-> <c- p>=></c-> <c- p>{</c->
    pipSession <c- o>=</c-> _pipSession<c- p>;</c->

    <c- c1>// Style remaining container to imply the player is in PiP.</c->
    playerContainer<c- p>.</c->classList<c- p>.</c->add<c- p>(</c-><c- t>'pip-mode'</c-><c- p>);</c->

    <c- c1>// Add player to the PiP window.</c->
    pipBody<c- p>.</c->append<c- p>(</c->player<c- p>);</c->

    <c- c1>// Listen for the PiP closing event to put the video back.</c->
    pipSession<c- p>.</c->window<c- p>.</c->addEventListener<c- p>(</c-><c- t>'unload'</c-><c- p>,</c-> onLeavePiP<c- p>.</c->bind<c- p>(</c->pipSession<c- p>),</c-> <c- p>{</c-> once<c- o>:</c-> <c- kc>true</c-> <c- p>});</c->
  <c- p>});</c->
<c- p>}</c->

<c- c1>// Called when the PiP window has closed.</c->
<c- a>function</c-> onLeavePiP<c- p>()</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- k>this</c-> <c- o>!==</c-> pipSession<c- p>)</c-> <c- p>{</c->
    <c- k>return</c-><c- p>;</c->
  <c- p>}</c->

  <c- c1>// Remove PiP styling from the container.</c->
  <c- a>const</c-> playerContainer <c- o>=</c-> document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#player-container'</c-><c- p>);</c->
  playerContainer<c- p>.</c->classList<c- p>.</c->remove<c- p>(</c-><c- t>'pip-mode'</c-><c- p>);</c->

  <c- c1>// Add the player back to the main window.</c->
  <c- a>const</c-> player <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#player'</c-><c- p>);</c->
  playerContainer<c- p>.</c->append<c- p>(</c->player<c- p>);</c->

  pipSession <c- o>=</c-> <c- kc>null</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="6.2" id="example-access-elements"><span class="secno">6.2. </span><span class="content">Accessing elements on the PiP Window</span><a class="self-link" href="#example-access-elements"></a></h3>
   <p>The document attribute provides access to the DOM of the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession①⑨">DocumentPictureInPictureSession</a></code> object:</p>
<pre class="lang-javascript highlight"><c- a>const</c-> video <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#video'</c-><c- p>);</c->
video<c- p>.</c->loop <c- o>=</c-> <c- kc>true</c-><c- p>;</c->
</pre>
   <h3 class="heading settled" data-level="6.3" id="example-listen-events"><span class="secno">6.3. </span><span class="content">Listening to events on the PiP Window</span><a class="self-link" href="#example-listen-events"></a></h3>
   <p>As part of creating an improved picture-in-picture experience, websites will often want
customize buttons and controls that need to respond to user input events such as clicks.</p>
<pre class="lang-javascript highlight"><c- a>const</c-> video <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#video'</c-><c- p>);</c->
<c- a>const</c-> muteButton <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->createElement<c- p>(</c-><c- t>'button'</c-><c- p>);</c->
muteButton<c- p>.</c->textContent <c- o>=</c-> <c- t>'Toggle mute'</c-><c- p>;</c->
muteButton<c- p>.</c->addEventListener<c- p>(</c-><c- t>'click'</c-><c- p>,</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
  video<c- p>.</c->muted <c- o>=</c-> <c- o>!</c->video<c- p>.</c->muted<c- p>;</c->
<c- p>});</c->
pipSession<c- p>.</c->document<c- p>.</c->body<c- p>.</c->append<c- p>(</c->muteButton<c- p>);</c->
</pre>
   <h3 class="heading settled" data-level="6.4" id="example-exiting-pip"><span class="secno">6.4. </span><span class="content">Exiting PiP</span><a class="self-link" href="#example-exiting-pip"></a></h3>
   <p>The website may want to close the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession②⓪">DocumentPictureInPictureSession</a></code> without the
user explicitly clicking on the window’s close button. They can do this by using
the <a class="idl-code" data-link-type="method" href="https://html.spec.whatwg.org/multipage/window-object.html#dom-window-close" id="ref-for-dom-window-close">close()</a> method on the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window②">Window</a></code> object:</p>
<pre class="lang-javascript highlight"><c- c1>// This will close the PiP window and trigger our existing onLeavePiP()</c->
<c- c1>// listener.</c->
pipSession<c- p>.</c->window<c- p>.</c->close<c- p>();</c->
</pre>
   <h3 class="heading settled" data-level="6.5" id="example-aspect-ratio"><span class="secno">6.5. </span><span class="content">Changing aspect ratio</span><a class="self-link" href="#example-aspect-ratio"></a></h3>
   <p>Sometimes the website will want to change the aspect ratio after the PiP window
is open (e.g., because a new video is playing with a different aspect ratio).
The website can change it via the <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-setaspectratio" id="ref-for-dom-documentpictureinpicturesession-setaspectratio①">setAspectRatio()</a></code> method on the <code class="idl"><a data-link-type="idl" href="#documentpictureinpicturesession" id="ref-for-documentpictureinpicturesession②①">DocumentPictureInPictureSession</a></code> object.</p>
<pre class="lang-javascript highlight"><c- a>const</c-> newVideo <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'video'</c-><c- p>);</c->
newVideo<c- p>.</c->id <c- o>=</c-> <c- t>'video'</c-><c- p>;</c->
newVideo<c- p>.</c->src <c- o>=</c-> <c- t>'newvideo.webm'</c-><c- p>;</c->
newVideo<c- p>.</c->addEventListener<c- p>(</c-><c- t>'loadedmetadata'</c-><c- p>,</c-> <c- k>async</c-> <c- p>(</c->_<c- p>)</c-> <c- p>=></c-> <c- p>{</c->
  <c- a>const</c-> aspectRatio <c- o>=</c-> newVideo<c- p>.</c->videoWidth <c- o>/</c-> newVideo<c- p>.</c->videoHeight<c- p>;</c->
  <c- a>const</c-> player <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#player'</c-><c- p>);</c->
  <c- a>const</c-> oldVideo <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#video'</c-><c- p>);</c->
  player<c- p>.</c->remove<c- p>(</c->oldVideo<c- p>);</c->
  player<c- p>.</c->append<c- p>(</c->newVideo<c- p>);</c->
  <c- k>await</c-> pipSession<c- p>.</c->setAspectRatio<c- p>(</c->aspectRatio<c- p>);</c->
<c- p>});</c->
newVideo<c- p>.</c->load<c- p>();</c->
</pre>
   <h3 class="heading settled" data-level="6.6" id="example-elements-out-on-close"><span class="secno">6.6. </span><span class="content">Getting elements out of the PiP window when it closes</span><a class="self-link" href="#example-elements-out-on-close"></a></h3>
   <p>When the PiP window is closed for any reason (either because the website
initiated it or the user closed it), the website will often want to get the
elements back out of the PiP window. The website can perform this in an event
handler for the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-unload" id="ref-for-event-unload">unload</a></code> event on the <code class="idl"><a data-link-type="idl" href="#dom-documentpictureinpicturesession-window" id="ref-for-dom-documentpictureinpicturesession-window①">window</a></code> object. This is shown in the <code>onLeavePiP()</code> handler in <a href="#example-video-player">video player example</a> above and is copied
below:</p>
<pre class="lang-javascript highlight"><c- c1>// Called when the PiP window has closed.</c->
<c- a>function</c-> onLeavePiP<c- p>()</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- k>this</c-> <c- o>!==</c-> pipSession<c- p>)</c-> <c- p>{</c->
    <c- k>return</c-><c- p>;</c->
  <c- p>}</c->

  <c- c1>// Remove PiP styling from the container.</c->
  <c- a>const</c-> playerContainer <c- o>=</c-> document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#player-container'</c-><c- p>);</c->
  playerContainer<c- p>.</c->classList<c- p>.</c->remove<c- p>(</c-><c- t>'pip-mode'</c-><c- p>);</c->

  <c- c1>// Add the player back to the main window.</c->
  <c- a>const</c-> player <c- o>=</c-> pipSession<c- p>.</c->document<c- p>.</c->querySelector<c- p>(</c-><c- t>'#player'</c-><c- p>);</c->
  playerContainer<c- p>.</c->append<c- p>(</c->player<c- p>);</c->

  pipSession <c- o>=</c-> <c- kc>null</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <h2 class="heading settled" data-level="7" id="acknowledgments"><span class="secno">7. </span><span class="content">Acknowledgments</span><a class="self-link" href="#acknowledgments"></a></h2>
   <p>Many thanks to Frank Liberato, Mark Foltz, Klaus Weidner, François Beaufort,
Charlie Reis, Joe DeBlasio, Domenic Denicola, and Yiren Wang for their comments
and contributions to this document and to the discussions that have informed it.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-documentpictureinpictureevent-documentpictureinpictureevent">constructor(type, eventInitDict)</a><span>, in § 4</span>
   <li><a href="#dom-documentpictureinpictureoptions-copystylesheets">copyStyleSheets</a><span>, in § 4</span>
   <li><a href="#dom-documentpictureinpicturesession-document">document</a><span>, in § 4</span>
   <li><a href="#documentpictureinpictureevent">DocumentPictureInPictureEvent</a><span>, in § 4</span>
   <li><a href="#dictdef-documentpictureinpictureeventinit">DocumentPictureInPictureEventInit</a><span>, in § 4</span>
   <li><a href="#dom-documentpictureinpictureevent-documentpictureinpictureevent">DocumentPictureInPictureEvent(type, eventInitDict)</a><span>, in § 4</span>
   <li><a href="#dictdef-documentpictureinpictureoptions">DocumentPictureInPictureOptions</a><span>, in § 4</span>
   <li><a href="#documentpictureinpicturesession">DocumentPictureInPictureSession</a><span>, in § 4</span>
   <li><a href="#document-picture-in-picture-support">Document Picture-in-Picture Support</a><span>, in § 5.4</span>
   <li><a href="#eventdef-pictureinpicture-enterpictureinpicture">enterpictureinpicture</a><span>, in § 4</span>
   <li><a href="#dom-documentpictureinpictureoptions-initialaspectratio">initialAspectRatio</a><span>, in § 4</span>
   <li><a href="#dom-documentpictureinpictureoptions-lockaspectratio">lockAspectRatio</a><span>, in § 4</span>
   <li><a href="#dom-pictureinpicture-onenterpictureinpicture">onenterpictureinpicture</a><span>, in § 4</span>
   <li><a href="#open-documentpictureinpicturesession">open DocumentPictureInPictureSession</a><span>, in § 5.1</span>
   <li><a href="#pictureinpicture">PictureInPicture</a><span>, in § 4</span>
   <li><a href="#dom-navigator-pictureinpicture">pictureInPicture</a><span>, in § 4</span>
   <li>
    pictureInPictureSession
    <ul>
     <li><a href="#dom-documentpictureinpictureevent-pictureinpicturesession">attribute for DocumentPictureInPictureEvent</a><span>, in § 4</span>
     <li><a href="#dom-documentpictureinpictureeventinit-pictureinpicturesession">dict-member for DocumentPictureInPictureEventInit</a><span>, in § 4</span>
    </ul>
   <li><a href="#dom-pictureinpicture-requestwindow">requestWindow()</a><span>, in § 4</span>
   <li><a href="#dom-pictureinpicture-requestwindow">requestWindow(options)</a><span>, in § 4</span>
   <li><a href="#dom-pictureinpicture-session">session</a><span>, in § 4</span>
   <li><a href="#set-aspect-ratio">set aspect ratio</a><span>, in § 5.2</span>
   <li><a href="#dom-documentpictureinpicturesession-setaspectratio">setAspectRatio(aspectRatio)</a><span>, in § 4</span>
   <li><a href="#set-lock-aspect-ratio">set lock aspect ratio</a><span>, in § 5.3</span>
   <li><a href="#dom-documentpictureinpicturesession-setlockaspectratio">setLockAspectRatio(lockAspectRatio)</a><span>, in § 4</span>
   <li><a href="#dom-documentpictureinpicturesession-window">window</a><span>, in § 4</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-css-style-sheet">
   <a href="https://drafts.csswg.org/cssom-1/#css-style-sheet">https://drafts.csswg.org/cssom-1/#css-style-sheet</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-css-style-sheet">5.1. Open DocumentPictureInPictureSession</a> <a href="#ref-for-css-style-sheet①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-document">
   <a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">1. Introduction</a>
    <li><a href="#ref-for-document①">4. API</a> <a href="#ref-for-document②">(2)</a>
    <li><a href="#ref-for-document③">5.6. Relative URLs</a> <a href="#ref-for-document④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event">
   <a href="https://dom.spec.whatwg.org/#event">https://dom.spec.whatwg.org/#event</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dictdef-eventinit">
   <a href="https://dom.spec.whatwg.org/#dictdef-eventinit">https://dom.spec.whatwg.org/#dictdef-eventinit</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-eventinit">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventtarget">
   <a href="https://dom.spec.whatwg.org/#eventtarget">https://dom.spec.whatwg.org/#eventtarget</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventtarget">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-event-bubbles">
   <a href="https://dom.spec.whatwg.org/#dom-event-bubbles">https://dom.spec.whatwg.org/#dom-event-bubbles</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-event-bubbles">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-event-fire">
   <a href="https://dom.spec.whatwg.org/#concept-event-fire">https://dom.spec.whatwg.org/#concept-event-fire</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-event-fire">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventhandler">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventhandler">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlvideoelement">
   <a href="https://html.spec.whatwg.org/multipage/media.html#htmlvideoelement">https://html.spec.whatwg.org/multipage/media.html#htmlvideoelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlvideoelement">1. Introduction</a>
    <li><a href="#ref-for-htmlvideoelement①">5.6. Relative URLs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-navigator">
   <a href="https://html.spec.whatwg.org/multipage/system-state.html#navigator">https://html.spec.whatwg.org/multipage/system-state.html#navigator</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigator">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">1. Introduction</a>
    <li><a href="#ref-for-window①">4. API</a>
    <li><a href="#ref-for-window②">6.4. Exiting PiP</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-document-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window">https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-window">5.1. Open DocumentPictureInPictureSession</a> <a href="#ref-for-concept-document-window①">(2)</a> <a href="#ref-for-concept-document-window②">(3)</a> <a href="#ref-for-concept-document-window③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-browsing-context">4. API</a>
    <li><a href="#ref-for-browsing-context①">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-window-close">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#dom-window-close">https://html.spec.whatwg.org/multipage/window-object.html#dom-window-close</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-window-close">6.4. Exiting PiP</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-document-defaultview">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#dom-document-defaultview">https://html.spec.whatwg.org/multipage/window-object.html#dom-document-defaultview</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-document-defaultview">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
   <a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">4. API</a> <a href="#ref-for-in-parallel①">(2)</a> <a href="#ref-for-in-parallel②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-open">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#dom-open">https://html.spec.whatwg.org/multipage/window-object.html#dom-open</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-open">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-task">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-media-src">
   <a href="https://html.spec.whatwg.org/multipage/media.html#dom-media-src">https://html.spec.whatwg.org/multipage/media.html#dom-media-src</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-media-src">5.6. Relative URLs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-transient-activation">
   <a href="https://html.spec.whatwg.org/multipage/interaction.html#transient-activation">https://html.spec.whatwg.org/multipage/interaction.html#transient-activation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transient-activation">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-unload">
   <a href="https://html.spec.whatwg.org/multipage/indices.html#event-unload">https://html.spec.whatwg.org/multipage/indices.html#event-unload</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-unload">6.6. Getting elements out of the PiP window when it closes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relative-url-string">
   <a href="https://url.spec.whatwg.org/#relative-url-string">https://url.spec.whatwg.org/#relative-url-string</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relative-url-string">5.6. Relative URLs</a> <a href="#ref-for-relative-url-string①">(2)</a> <a href="#ref-for-relative-url-string②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-url">
   <a href="https://url.spec.whatwg.org/#concept-url">https://url.spec.whatwg.org/#concept-url</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-url">5.1. Open DocumentPictureInPictureSession</a>
    <li><a href="#ref-for-concept-url①">5.6. Relative URLs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://webidl.spec.whatwg.org/#idl-DOMString">https://webidl.spec.whatwg.org/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">4. API</a> <a href="#ref-for-Exposed①">(2)</a> <a href="#ref-for-Exposed②">(3)</a> <a href="#ref-for-Exposed③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-invalidstateerror">
   <a href="https://webidl.spec.whatwg.org/#invalidstateerror">https://webidl.spec.whatwg.org/#invalidstateerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invalidstateerror">5.2. Set Aspect Ratio</a>
    <li><a href="#ref-for-invalidstateerror①">5.3. Lock Aspect Ratio</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-notallowederror">
   <a href="https://webidl.spec.whatwg.org/#notallowederror">https://webidl.spec.whatwg.org/#notallowederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notallowederror">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-notsupportederror">
   <a href="https://webidl.spec.whatwg.org/#notsupportederror">https://webidl.spec.whatwg.org/#notsupportederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notsupportederror">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">4. API</a> <a href="#ref-for-idl-promise①">(2)</a> <a href="#ref-for-idl-promise②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-exceptiondef-rangeerror">
   <a href="https://webidl.spec.whatwg.org/#exceptiondef-rangeerror">https://webidl.spec.whatwg.org/#exceptiondef-rangeerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-exceptiondef-rangeerror">5.2. Set Aspect Ratio</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SameObject">
   <a href="https://webidl.spec.whatwg.org/#SameObject">https://webidl.spec.whatwg.org/#SameObject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SameObject">4. API</a> <a href="#ref-for-SameObject①">(2)</a> <a href="#ref-for-SameObject②">(3)</a> <a href="#ref-for-SameObject③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SecureContext">
   <a href="https://webidl.spec.whatwg.org/#SecureContext">https://webidl.spec.whatwg.org/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-new-promise">
   <a href="https://webidl.spec.whatwg.org/#a-new-promise">https://webidl.spec.whatwg.org/#a-new-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-new-promise">4. API</a> <a href="#ref-for-a-new-promise①">(2)</a> <a href="#ref-for-a-new-promise②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-boolean">
   <a href="https://webidl.spec.whatwg.org/#idl-boolean">https://webidl.spec.whatwg.org/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">4. API</a> <a href="#ref-for-idl-boolean①">(2)</a> <a href="#ref-for-idl-boolean②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-float">
   <a href="https://webidl.spec.whatwg.org/#idl-float">https://webidl.spec.whatwg.org/#idl-float</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-float">4. API</a> <a href="#ref-for-idl-float①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-this">
   <a href="https://webidl.spec.whatwg.org/#this">https://webidl.spec.whatwg.org/#this</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-this">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-undefined">
   <a href="https://webidl.spec.whatwg.org/#idl-undefined">https://webidl.spec.whatwg.org/#idl-undefined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-undefined">4. API</a> <a href="#ref-for-idl-undefined①">(2)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSSOM-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-css-style-sheet">css style sheet</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-document">Document</span>
     <li><span class="dfn-paneled" id="term-for-event">Event</span>
     <li><span class="dfn-paneled" id="term-for-dictdef-eventinit">EventInit</span>
     <li><span class="dfn-paneled" id="term-for-eventtarget">EventTarget</span>
     <li><span class="dfn-paneled" id="term-for-dom-event-bubbles">bubbles</span>
     <li><span class="dfn-paneled" id="term-for-concept-event-fire">fire an event</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-eventhandler">EventHandler</span>
     <li><span class="dfn-paneled" id="term-for-htmlvideoelement">HTMLVideoElement</span>
     <li><span class="dfn-paneled" id="term-for-navigator">Navigator</span>
     <li><span class="dfn-paneled" id="term-for-window">Window</span>
     <li><span class="dfn-paneled" id="term-for-concept-document-window">associated document</span>
     <li><span class="dfn-paneled" id="term-for-browsing-context">browsing context</span>
     <li><span class="dfn-paneled" id="term-for-dom-window-close">close()</span>
     <li><span class="dfn-paneled" id="term-for-dom-document-defaultview">defaultView</span>
     <li><span class="dfn-paneled" id="term-for-in-parallel">in parallel</span>
     <li><span class="dfn-paneled" id="term-for-dom-open">open(url, target, features)</span>
     <li><span class="dfn-paneled" id="term-for-queue-a-task">queue a task</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-dom-media-src">src</span>
     <li><span class="dfn-paneled" id="term-for-transient-activation">transient activation</span>
     <li><span class="dfn-paneled" id="term-for-event-unload">unload</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-relative-url-string">relative-url string</span>
     <li><span class="dfn-paneled" id="term-for-concept-url">url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-invalidstateerror">InvalidStateError</span>
     <li><span class="dfn-paneled" id="term-for-notallowederror">NotAllowedError</span>
     <li><span class="dfn-paneled" id="term-for-notsupportederror">NotSupportedError</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
     <li><span class="dfn-paneled" id="term-for-exceptiondef-rangeerror">RangeError</span>
     <li><span class="dfn-paneled" id="term-for-SameObject">SameObject</span>
     <li><span class="dfn-paneled" id="term-for-SecureContext">SecureContext</span>
     <li><span class="dfn-paneled" id="term-for-a-new-promise">a new promise</span>
     <li><span class="dfn-paneled" id="term-for-idl-boolean">boolean</span>
     <li><span class="dfn-paneled" id="term-for-idl-float">float</span>
     <li><span class="dfn-paneled" id="term-for-this">this</span>
     <li><span class="dfn-paneled" id="term-for-idl-undefined">undefined</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-cssom-1">[CSSOM-1]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM)</cite></a>. URL: <a href="https://drafts.csswg.org/cssom/">https://drafts.csswg.org/cssom/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator"><c- g>Navigator</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#pictureinpicture"><c- n>PictureInPicture</c-></a>
    <a data-readonly data-type="PictureInPicture" href="#dom-navigator-pictureinpicture"><code><c- g>pictureInPicture</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#pictureinpicture"><code><c- g>PictureInPicture</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#documentpictureinpicturesession"><c- n>DocumentPictureInPictureSession</c-></a>> <a href="#dom-pictureinpicture-requestwindow"><code><c- g>requestWindow</c-></code></a>(
    <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-documentpictureinpictureoptions"><c- n>DocumentPictureInPictureOptions</c-></a> <a href="#dom-pictureinpicture-requestwindow-options-options"><code><c- g>options</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#documentpictureinpicturesession"><c- n>DocumentPictureInPictureSession</c-></a> <a data-readonly data-type="DocumentPictureInPictureSession" href="#dom-pictureinpicture-session"><code><c- g>session</c-></code></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a data-type="EventHandler" href="#dom-pictureinpicture-onenterpictureinpicture"><code><c- g>onenterpictureinpicture</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-documentpictureinpictureoptions"><code><c- g>DocumentPictureInPictureOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-float"><c- b>float</c-></a> <a data-default="0.0" data-type="float " href="#dom-documentpictureinpictureoptions-initialaspectratio"><code><c- g>initialAspectRatio</c-></code></a> = 0.0;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-documentpictureinpictureoptions-lockaspectratio"><code><c- g>lockAspectRatio</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-documentpictureinpictureoptions-copystylesheets"><code><c- g>copyStyleSheets</c-></code></a> = <c- b>false</c->;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#documentpictureinpicturesession"><code><c- g>DocumentPictureInPictureSession</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#document"><c- n>Document</c-></a>? <a data-readonly data-type="Document?" href="#dom-documentpictureinpicturesession-document"><code><c- g>document</c-></code></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/window-object.html#window"><c- n>Window</c-></a>? <a data-readonly data-type="Window?" href="#dom-documentpictureinpicturesession-window"><code><c- g>window</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a href="#dom-documentpictureinpicturesession-setaspectratio"><code><c- g>setAspectRatio</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-float"><c- b>float</c-></a> <a href="#dom-documentpictureinpicturesession-setaspectratio-aspectratio-aspectratio"><code><c- g>aspectRatio</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a href="#dom-documentpictureinpicturesession-setlockaspectratio"><code><c- g>setLockAspectRatio</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a href="#dom-documentpictureinpicturesession-setlockaspectratio-lockaspectratio-lockaspectratio"><code><c- g>lockAspectRatio</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#documentpictureinpictureevent"><code><c- g>DocumentPictureInPictureEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
  <a href="#dom-documentpictureinpictureevent-documentpictureinpictureevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-documentpictureinpictureevent-documentpictureinpictureevent-type-eventinitdict-type"><code><c- g>type</c-></code></a>, <a data-link-type="idl-name" href="#dictdef-documentpictureinpictureeventinit"><c- n>DocumentPictureInPictureEventInit</c-></a> <a href="#dom-documentpictureinpictureevent-documentpictureinpictureevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#documentpictureinpicturesession"><c- n>DocumentPictureInPictureSession</c-></a>
    <a data-readonly data-type="DocumentPictureInPictureSession" href="#dom-documentpictureinpictureevent-pictureinpicturesession"><code><c- g>pictureInPictureSession</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-documentpictureinpictureeventinit"><code><c- g>DocumentPictureInPictureEventInit</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit"><c- n>EventInit</c-></a> {
  <c- b>required</c-> <a data-link-type="idl-name" href="#documentpictureinpicturesession"><c- n>DocumentPictureInPictureSession</c-></a> <a data-type="DocumentPictureInPictureSession " href="#dom-documentpictureinpictureeventinit-pictureinpicturesession"><code><c- g>pictureInPictureSession</c-></code></a>;
};

</pre>
  <aside class="dfn-panel" data-for="pictureinpicture">
   <b><a href="#pictureinpicture">#pictureinpicture</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pictureinpicture">4. API</a> <a href="#ref-for-pictureinpicture①">(2)</a> <a href="#ref-for-pictureinpicture②">(3)</a>
    <li><a href="#ref-for-pictureinpicture③">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-pictureinpicture-requestwindow">
   <b><a href="#dom-pictureinpicture-requestwindow">#dom-pictureinpicture-requestwindow</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-pictureinpicture-requestwindow">4. API</a> <a href="#ref-for-dom-pictureinpicture-requestwindow①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-pictureinpicture-session">
   <b><a href="#dom-pictureinpicture-session">#dom-pictureinpicture-session</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-pictureinpicture-session">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-documentpictureinpictureoptions">
   <b><a href="#dictdef-documentpictureinpictureoptions">#dictdef-documentpictureinpictureoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-documentpictureinpictureoptions">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpictureoptions-initialaspectratio">
   <b><a href="#dom-documentpictureinpictureoptions-initialaspectratio">#dom-documentpictureinpictureoptions-initialaspectratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpictureoptions-initialaspectratio">5.1. Open DocumentPictureInPictureSession</a> <a href="#ref-for-dom-documentpictureinpictureoptions-initialaspectratio①">(2)</a> <a href="#ref-for-dom-documentpictureinpictureoptions-initialaspectratio②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpictureoptions-lockaspectratio">
   <b><a href="#dom-documentpictureinpictureoptions-lockaspectratio">#dom-documentpictureinpictureoptions-lockaspectratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpictureoptions-lockaspectratio">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpictureoptions-copystylesheets">
   <b><a href="#dom-documentpictureinpictureoptions-copystylesheets">#dom-documentpictureinpictureoptions-copystylesheets</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpictureoptions-copystylesheets">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="documentpictureinpicturesession">
   <b><a href="#documentpictureinpicturesession">#documentpictureinpicturesession</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-documentpictureinpicturesession">3.2. Spoofing</a> <a href="#ref-for-documentpictureinpicturesession①">(2)</a>
    <li><a href="#ref-for-documentpictureinpicturesession②">4. API</a> <a href="#ref-for-documentpictureinpicturesession③">(2)</a> <a href="#ref-for-documentpictureinpicturesession④">(3)</a> <a href="#ref-for-documentpictureinpicturesession⑤">(4)</a> <a href="#ref-for-documentpictureinpicturesession⑥">(5)</a> <a href="#ref-for-documentpictureinpicturesession⑦">(6)</a> <a href="#ref-for-documentpictureinpicturesession⑧">(7)</a> <a href="#ref-for-documentpictureinpicturesession⑨">(8)</a> <a href="#ref-for-documentpictureinpicturesession①⓪">(9)</a>
    <li><a href="#ref-for-documentpictureinpicturesession①①">5.1. Open DocumentPictureInPictureSession</a> <a href="#ref-for-documentpictureinpicturesession①②">(2)</a>
    <li><a href="#ref-for-documentpictureinpicturesession①③">5.2. Set Aspect Ratio</a>
    <li><a href="#ref-for-documentpictureinpicturesession①④">5.3. Lock Aspect Ratio</a>
    <li><a href="#ref-for-documentpictureinpicturesession①⑤">5.5. One PiP Window</a>
    <li><a href="#ref-for-documentpictureinpicturesession①⑥">5.6. Relative URLs</a> <a href="#ref-for-documentpictureinpicturesession①⑦">(2)</a> <a href="#ref-for-documentpictureinpicturesession①⑧">(3)</a>
    <li><a href="#ref-for-documentpictureinpicturesession①⑨">6.2. Accessing elements on the PiP Window</a>
    <li><a href="#ref-for-documentpictureinpicturesession②⓪">6.4. Exiting PiP</a>
    <li><a href="#ref-for-documentpictureinpicturesession②①">6.5. Changing aspect ratio</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpicturesession-document">
   <b><a href="#dom-documentpictureinpicturesession-document">#dom-documentpictureinpicturesession-document</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpicturesession-document">5.1. Open DocumentPictureInPictureSession</a> <a href="#ref-for-dom-documentpictureinpicturesession-document①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpicturesession-window">
   <b><a href="#dom-documentpictureinpicturesession-window">#dom-documentpictureinpicturesession-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpicturesession-window">5.1. Open DocumentPictureInPictureSession</a>
    <li><a href="#ref-for-dom-documentpictureinpicturesession-window①">6.6. Getting elements out of the PiP window when it closes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpicturesession-setaspectratio">
   <b><a href="#dom-documentpictureinpicturesession-setaspectratio">#dom-documentpictureinpicturesession-setaspectratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpicturesession-setaspectratio">4. API</a>
    <li><a href="#ref-for-dom-documentpictureinpicturesession-setaspectratio①">6.5. Changing aspect ratio</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpicturesession-setlockaspectratio">
   <b><a href="#dom-documentpictureinpicturesession-setlockaspectratio">#dom-documentpictureinpicturesession-setlockaspectratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpicturesession-setlockaspectratio">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="documentpictureinpictureevent">
   <b><a href="#documentpictureinpictureevent">#documentpictureinpictureevent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-documentpictureinpictureevent">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-documentpictureinpictureevent-pictureinpicturesession">
   <b><a href="#dom-documentpictureinpictureevent-pictureinpicturesession">#dom-documentpictureinpictureevent-pictureinpicturesession</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-documentpictureinpictureevent-pictureinpicturesession">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-documentpictureinpictureeventinit">
   <b><a href="#dictdef-documentpictureinpictureeventinit">#dictdef-documentpictureinpictureeventinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-documentpictureinpictureeventinit">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-pictureinpicture-enterpictureinpicture">
   <b><a href="#eventdef-pictureinpicture-enterpictureinpicture">#eventdef-pictureinpicture-enterpictureinpicture</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventdef-pictureinpicture-enterpictureinpicture">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="open-documentpictureinpicturesession">
   <b><a href="#open-documentpictureinpicturesession">#open-documentpictureinpicturesession</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-open-documentpictureinpicturesession">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-aspect-ratio">
   <b><a href="#set-aspect-ratio">#set-aspect-ratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-aspect-ratio">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-lock-aspect-ratio">
   <b><a href="#set-lock-aspect-ratio">#set-lock-aspect-ratio</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-lock-aspect-ratio">4. API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-picture-in-picture-support">
   <b><a href="#document-picture-in-picture-support">#document-picture-in-picture-support</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-picture-in-picture-support">5.1. Open DocumentPictureInPictureSession</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>